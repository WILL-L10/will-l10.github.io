<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta http-equiv=Accept-CH content="DPR, Viewport-Width, Width"><link rel=icon href=/images/favicon.png type=image/gif><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" media=print onload='this.media="all"'><noscript><link href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel=stylesheet></noscript><link rel=stylesheet href=/css/font.css media=all><meta property="og:url" content="https://will-l10.github.io/blogs/mips-processor/"><meta property="og:site_name" content="William Lazcano | Computer & Electrical Engineering"><meta property="og:title" content="MIPS Processor with Extended ISA"><meta property="og:description" content="Single-cycle MIPS processor with subroutine support (JAL/JR instructions)"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="blogs"><meta property="article:published_time" content="2024-09-20T00:00:00+00:00"><meta property="article:modified_time" content="2024-09-20T00:00:00+00:00"><meta property="article:tag" content="MIPS"><meta property="article:tag" content="FPGA"><meta property="article:tag" content="SystemVerilog"><meta property="article:tag" content="Pipelining"><meta name=twitter:card content="summary"><meta name=twitter:title content="MIPS Processor with Extended ISA"><meta name=twitter:description content="Single-cycle MIPS processor with subroutine support (JAL/JR instructions)"><link rel=stylesheet href=/bootstrap-5/css/bootstrap.min.css media=all><link rel=stylesheet href=/css/header.css media=all><link rel=stylesheet href=/css/footer.css media=all><link rel=stylesheet href=/css/theme.css media=all><style>:root{--text-color:#343a40;--text-secondary-color:#6c757d;--text-link-color:#007bff;--background-color:#eaedf0;--secondary-background-color:#64ffda1a;--primary-color:#007bff;--secondary-color:#f8f9fa;--text-color-dark:#e4e6eb;--text-secondary-color-dark:#b0b3b8;--text-link-color-dark:#ffffff;--background-color-dark:#18191a;--secondary-background-color-dark:#212529;--primary-color-dark:#ffffff;--secondary-color-dark:#212529}body{font-size:1rem;font-weight:400;line-height:1.5;text-align:left}html{background-color:var(--background-color)!important}body::-webkit-scrollbar{height:0;width:8px;background-color:var(--background-color)}::-webkit-scrollbar-track{border-radius:1rem}::-webkit-scrollbar-thumb{border-radius:1rem;background:#b0b0b0;outline:1px solid var(--background-color)}#search-content::-webkit-scrollbar{width:.5em;height:.1em;background-color:var(--background-color)}</style><meta name=description content="Single-cycle MIPS processor with subroutine support (JAL/JR instructions)"><link rel=stylesheet href=/css/single.css><script defer src=/fontawesome-6/all-6.4.2.js></script><title>MIPS Processor with Extended ISA | William Lazcano | Computer & Electrical Engineering</title></head><body class=light><script>let localStorageValue=localStorage.getItem("pref-theme"),mediaQuery=window.matchMedia("(prefers-color-scheme: dark)").matches;switch(localStorageValue){case"dark":document.documentElement.classList.add("dark"),document.body.classList.add("dark");break;case"light":document.body.classList.remove("dark"),document.documentElement.classList.remove("dark");break;default:mediaQuery&&(document.documentElement.classList.add("dark"),document.body.classList.add("dark"));break}</script><header id=profileHeader><nav class="pt-3 navbar navbar-expand-lg"><div class="container-fluid mx-xs-2 mx-sm-5 mx-md-5 mx-lg-5"><a class="navbar-brand primary-font text-wrap" href=/><img src=/images/favicon.png width=30 height=30 class="d-inline-block align-top">
William Lazcano</a><div><input id=search autocomplete=off class="form-control mr-sm-2 d-none d-md-block" placeholder='Ctrl + k to Search...' aria-label=Search oninput=searchOnChange(event)></div><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarContent aria-controls=navbarContent aria-expanded=false aria-label="Toggle navigation">
<svg aria-hidden="true" height="24" viewBox="0 0 16 16" width="24" data-view-component="true"><path fill-rule="evenodd" d="M1 2.75A.75.75.0 011.75 2h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 2.75zm0 5A.75.75.0 011.75 7h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 7.75zM1.75 12a.75.75.0 100 1.5h12.5a.75.75.0 100-1.5H1.75z"/></svg></button><div class="collapse navbar-collapse text-wrap primary-font" id=navbarContent><ul class="navbar-nav ms-auto text-center"><li class="nav-item navbar-text d-block d-md-none"><div class=nav-link><input id=search autocomplete=off class="form-control mr-sm-2" placeholder='Ctrl + k to Search...' aria-label=Search oninput=searchOnChange(event)></div></li><li class="nav-item navbar-text"><a class=nav-link href=/#about aria-label=about>About Me</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#experience aria-label=experience>Experience</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#education aria-label=education>Education</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#achievements aria-label=achievements>Achievements</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#contact aria-label=contact>Get in Touch</a></li><li class="nav-item navbar-text"><a class=nav-link href=/blogs/ title>Blog</a></li><li class="nav-item navbar-text"><div class=text-center><button id=theme-toggle>
<svg id="moon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></li></ul></div></div></nav></header><div id=content><section id=single><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-md-12 col-lg-9"><div class=pr-lg-4><div class="title mb-5"><h1 class="text-center mb-4">MIPS Processor with Extended ISA</h1><div class=text-center>William Lazcano
<small>|</small>
Sep 20, 2024
<span id=readingTime>min read</span></div></div><div class=featured-image><img class="img-fluid mx-auto d-block" src=/images/projects/mips.jpg alt="MIPS Processor with Extended ISA"></div><article class="page-content p-2"><h2 id=project-overview>Project Overview</h2><p>Designed and implemented a complete <strong>single-cycle MIPS processor</strong> supporting Load/Store architecture with <strong>32 general-purpose registers</strong>. Successfully added <strong>JAL (Jump and Link)</strong> and <strong>JR (Jump Register)</strong> instructions to enable subroutine calls and returns—essential for structured programming.</p><p><img src=/images/projects/mips.jpg alt="MIPS Processor Datapath"></p><h3 id=project-specifications>Project Specifications</h3><table><thead><tr><th>Feature</th><th>Details</th></tr></thead><tbody><tr><td><strong>Architecture</strong></td><td>32-bit single-cycle MIPS</td></tr><tr><td><strong>Register File</strong></td><td>32 × 32-bit registers</td></tr><tr><td><strong>Memory Model</strong></td><td>Harvard (separate I/D)</td></tr><tr><td><strong>Custom Instructions</strong></td><td>JAL, JR for subroutines</td></tr><tr><td><strong>Platform</strong></td><td>Altera DE2-115 FPGA</td></tr><tr><td><strong>Clock Speed</strong></td><td>50 MHz (stable)</td></tr><tr><td><strong>Language</strong></td><td>SystemVerilog</td></tr><tr><td><strong>Display</strong></td><td>7-segment (PC, instructions, memory ops)</td></tr></tbody></table><h2 id=architecture-overview>Architecture Overview</h2><h3 id=mips-processor-block-diagram>MIPS Processor Block Diagram</h3><pre tabindex=0><code>                    ┌──────────────────────────────────────┐
                    │      MIPS Processor Core             │
                    │                                      │
   ┌─────────┐      │  ┌──────┐    ┌─────┐    ┌────────┐ │
   │ Instr   │─────▶│  │  PC  │───▶│ +4  │───▶│  MUX   │ │
   │ Memory  │      │  └──┬───┘    └──┬──┘    └───┬────┘ │
   └─────────┘      │     │           │            │      │
                    │     │      ┌────▼────┐       │      │
                    │     │      │ Branch  │       │      │
                    │     │      │ Target  │       │      │
                    │     │      └────┬────┘       │      │
                    │     │           │            │      │
                    │     │      ┌────▼────┐       │      │
                    │     │      │  JAL    │       │      │
                    │     │      │ Target  │       │      │
                    │     │      └────┬────┘       │      │
                    │     │           │            │      │
                    │     └───────────┴────────────┘      │
                    │                                      │
                    │  ┌────────────────────────────────┐ │
                    │  │     Instruction Register       │ │
                    │  └─────────────┬──────────────────┘ │
                    │                ▼                     │
                    │  ┌────────────────────────────────┐ │
                    │  │        Control Unit             │ │
                    │  │  • RegDst  • MemtoReg           │ │
                    │  │  • RegWrite • MemWrite          │ │
                    │  │  • ALUSrc  • PCSrc              │ │
                    │  └─────────────┬──────────────────┘ │
                    │                ▼                     │
                    │  ┌────────────────────────────────┐ │
                    │  │   Register File (32 × 32-bit)  │ │
                    │  │                                 │ │
                    │  │  Read Port 1  ─────────────┐   │ │
                    │  │  Read Port 2  ─────────┐   │   │ │
                    │  │  Write Port ($31 for JAL)  │   │ │
                    │  └───────────────┬──────┬─────┘   │ │
                    │                  │      │          │ │
                    │            ┌─────▼──────▼─────┐   │ │
                    │            │  MUX (ALUSrc)    │   │ │
                    │            └─────────┬────────┘   │ │
                    │                      ▼             │ │
                    │            ┌─────────────────┐    │ │
                    │            │   ALU (32-bit)  │    │ │
                    │            │   • ADD  • SUB  │    │ │
                    │            │   • AND  • OR   │    │ │
                    │            │   • SLT  • SLL  │    │ │
                    │            └────────┬────────┘    │ │
                    │                     ▼              │ │
   ┌─────────┐      │            ┌────────────────┐    │ │
   │  Data   │◀────▶│            │ Data Memory    │    │ │
   │ Memory  │      │            │  (1KB)         │    │ │
   └─────────┘      │            └────────┬───────┘    │ │
                    │                     ▼              │ │
                    │            ┌────────────────┐    │ │
                    │            │  MUX (MemtoReg)│    │ │
                    │            └────────┬───────┘    │ │
                    │                     │             │ │
                    │                     └─────────────┘ │
                    └──────────────────────────────────────┘
</code></pre><h3 id=core-features>Core Features</h3><p><strong>Load/Store Architecture:</strong></p><ul><li>Memory operations only through LW/SW instructions</li><li>All arithmetic operates on registers</li><li>Separate instruction and data memory</li></ul><p><strong>32 General-Purpose Registers:</strong></p><ul><li>R0: Always zero (hardwired)</li><li>R1-R30: General purpose</li><li>R31: Return address (used by JAL)</li></ul><p><strong>Subroutine Support:</strong></p><ul><li>JAL: Jump and Link (function calls)</li><li>JR: Jump Register (function returns)</li></ul><h2 id=instruction-set-extensions>Instruction Set Extensions</h2><h3 id=jal-jump-and-link>JAL (Jump and Link)</h3><p><strong>Purpose:</strong> Call a subroutine and save return address</p><p><strong>Operation:</strong></p><pre tabindex=0><code>$31 = PC + 4        // Save return address
PC = {PC[31:28], address[25:0], 2&#39;b00}  // Jump to target
</code></pre><p><strong>Format:</strong></p><pre tabindex=0><code>┌────────┬──────────────────────────────┐
│ Opcode │      Target Address          │
│  (6)   │           (26)               │
└────────┴──────────────────────────────┘
  000011   aaaaaaaaaaaaaaaaaaaaaaaaaa
</code></pre><p><strong>SystemVerilog Implementation:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-systemverilog data-lang=systemverilog><span style=display:flex><span><span style=color:#66d9ef>module</span> pc_logic(
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>input</span>  <span style=color:#66d9ef>logic</span>        clk,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>input</span>  <span style=color:#66d9ef>logic</span>        reset,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>input</span>  <span style=color:#66d9ef>logic</span> [<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>]  pc_src,      <span style=color:#75715e>// 00=+4, 01=branch, 10=JAL, 11=JR
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>input</span>  <span style=color:#66d9ef>logic</span> [<span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>] pc,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>input</span>  <span style=color:#66d9ef>logic</span> [<span style=color:#ae81ff>25</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>] jump_addr,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>input</span>  <span style=color:#66d9ef>logic</span> [<span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>] jr_addr,     <span style=color:#75715e>// From register
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>output</span> <span style=color:#66d9ef>logic</span> [<span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>] pc_next
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>logic</span> [<span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>] pc_plus4;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>logic</span> [<span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>] jal_target;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assign</span> pc_plus4 <span style=color:#f92672>=</span> pc <span style=color:#f92672>+</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assign</span> jal_target <span style=color:#f92672>=</span> {pc[<span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>28</span>], jump_addr, <span style=color:#ae81ff>2</span><span style=color:#ae81ff>&#39;b00</span>};
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>always_comb</span> <span style=color:#66d9ef>begin</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span>(pc_src)
</span></span><span style=display:flex><span>            <span style=color:#ae81ff>2</span><span style=color:#ae81ff>&#39;b00</span><span style=color:#f92672>:</span> pc_next <span style=color:#f92672>=</span> pc_plus4;      <span style=color:#75715e>// Normal increment
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#ae81ff>2</span><span style=color:#ae81ff>&#39;b01</span><span style=color:#f92672>:</span> pc_next <span style=color:#f92672>=</span> branch_target; <span style=color:#75715e>// Branch
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#ae81ff>2</span><span style=color:#ae81ff>&#39;b10</span><span style=color:#f92672>:</span> pc_next <span style=color:#f92672>=</span> jal_target;    <span style=color:#75715e>// JAL
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#ae81ff>2</span><span style=color:#ae81ff>&#39;b11</span><span style=color:#f92672>:</span> pc_next <span style=color:#f92672>=</span> jr_addr;       <span style=color:#75715e>// JR
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>endcase</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#66d9ef>endmodule</span>
</span></span></code></pre></div><h3 id=jr-jump-register>JR (Jump Register)</h3><p><strong>Purpose:</strong> Return from subroutine using saved address</p><p><strong>Operation:</strong></p><pre tabindex=0><code>PC = R[rs]    // Jump to address in register (typically $31)
</code></pre><p><strong>Format:</strong></p><pre tabindex=0><code>┌────────┬─────┬─────┬─────┬─────┬────────┐
│ Opcode │ rs  │  0  │  0  │  0  │ Funct  │
│  (6)   │ (5) │ (5) │ (5) │ (5) │  (6)   │
└────────┴─────┴─────┴─────┴─────┴────────┘
  000000  11111  00000 00000 00000 001000
           $31                      (JR)
</code></pre><p><strong>SystemVerilog Implementation:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-systemverilog data-lang=systemverilog><span style=display:flex><span><span style=color:#66d9ef>module</span> control_unit(
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>input</span>  <span style=color:#66d9ef>logic</span> [<span style=color:#ae81ff>5</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>] opcode,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>input</span>  <span style=color:#66d9ef>logic</span> [<span style=color:#ae81ff>5</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>] funct,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>output</span> <span style=color:#66d9ef>logic</span>       reg_write,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>output</span> <span style=color:#66d9ef>logic</span>       mem_write,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>output</span> <span style=color:#66d9ef>logic</span>       mem_to_reg,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>output</span> <span style=color:#66d9ef>logic</span> [<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>] reg_dst,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>output</span> <span style=color:#66d9ef>logic</span> [<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>] pc_src,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>output</span> <span style=color:#66d9ef>logic</span> [<span style=color:#ae81ff>2</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>] alu_control
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>always_comb</span> <span style=color:#66d9ef>begin</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Default values
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        reg_write <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        mem_write <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        mem_to_reg <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        reg_dst <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span><span style=color:#ae81ff>&#39;b01</span>;  <span style=color:#75715e>// rd
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        pc_src <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span><span style=color:#ae81ff>&#39;b00</span>;   <span style=color:#75715e>// PC+4
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span>(opcode)
</span></span><span style=display:flex><span>            <span style=color:#ae81ff>6</span><span style=color:#ae81ff>&#39;b000000</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>begin</span>  <span style=color:#75715e>// R-type
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                reg_write <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>case</span>(funct)
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>6</span><span style=color:#ae81ff>&#39;b001000</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>begin</span>  <span style=color:#75715e>// JR
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                        pc_src <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span><span style=color:#ae81ff>&#39;b11</span>;     <span style=color:#75715e>// Jump to register
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                        reg_write <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;      <span style=color:#75715e>// Don&#39;t write register
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>6</span><span style=color:#ae81ff>&#39;b100000</span><span style=color:#f92672>:</span> alu_control <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span><span style=color:#ae81ff>&#39;b010</span>; <span style=color:#75715e>// ADD
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#ae81ff>6</span><span style=color:#ae81ff>&#39;b100010</span><span style=color:#f92672>:</span> alu_control <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span><span style=color:#ae81ff>&#39;b110</span>; <span style=color:#75715e>// SUB
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#ae81ff>6</span><span style=color:#ae81ff>&#39;b100100</span><span style=color:#f92672>:</span> alu_control <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span><span style=color:#ae81ff>&#39;b000</span>; <span style=color:#75715e>// AND
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#ae81ff>6</span><span style=color:#ae81ff>&#39;b100101</span><span style=color:#f92672>:</span> alu_control <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span><span style=color:#ae81ff>&#39;b001</span>; <span style=color:#75715e>// OR
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#75715e>// ... other R-type instructions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>endcase</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#ae81ff>6</span><span style=color:#ae81ff>&#39;b000011</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>begin</span>  <span style=color:#75715e>// JAL
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                reg_write <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>                reg_dst <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span><span style=color:#ae81ff>&#39;b10</span>;   <span style=color:#75715e>// Write to $31
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                pc_src <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span><span style=color:#ae81ff>&#39;b10</span>;    <span style=color:#75715e>// Jump to target
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#ae81ff>6</span><span style=color:#ae81ff>&#39;b100011</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>begin</span>  <span style=color:#75715e>// LW
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                reg_write <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>                mem_to_reg <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>                alu_control <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span><span style=color:#ae81ff>&#39;b010</span>; <span style=color:#75715e>// ADD for address calc
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#ae81ff>6</span><span style=color:#ae81ff>&#39;b101011</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>begin</span>  <span style=color:#75715e>// SW
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                mem_write <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>                alu_control <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span><span style=color:#ae81ff>&#39;b010</span>; <span style=color:#75715e>// ADD for address calc
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e>// ... other instructions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>endcase</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#66d9ef>endmodule</span>
</span></span></code></pre></div><h2 id=datapath-extensions-for-jaljr>Datapath Extensions for JAL/JR</h2><h3 id=register-destination-mux>Register Destination MUX</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-systemverilog data-lang=systemverilog><span style=display:flex><span><span style=color:#66d9ef>module</span> register_file(
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>input</span>  <span style=color:#66d9ef>logic</span>        clk,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>input</span>  <span style=color:#66d9ef>logic</span>        we3,          <span style=color:#75715e>// Write enable
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>input</span>  <span style=color:#66d9ef>logic</span> [<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>]  reg_dst,      <span style=color:#75715e>// Destination select
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>input</span>  <span style=color:#66d9ef>logic</span> [<span style=color:#ae81ff>4</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>]  ra1, ra2,     <span style=color:#75715e>// Read addresses
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>input</span>  <span style=color:#66d9ef>logic</span> [<span style=color:#ae81ff>4</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>]  rt, rd,       <span style=color:#75715e>// Write address sources
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>input</span>  <span style=color:#66d9ef>logic</span> [<span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>] wd3,          <span style=color:#75715e>// Write data
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>output</span> <span style=color:#66d9ef>logic</span> [<span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>] rd1, rd2      <span style=color:#75715e>// Read data
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>logic</span> [<span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>] registers [<span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>logic</span> [<span style=color:#ae81ff>4</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>] wa3;  <span style=color:#75715e>// Actual write address
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Register 0 is always 0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>assign</span> registers[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>32</span><span style=color:#ae81ff>&#39;b0</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Write address MUX
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>always_comb</span> <span style=color:#66d9ef>begin</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span>(reg_dst)
</span></span><span style=display:flex><span>            <span style=color:#ae81ff>2</span><span style=color:#ae81ff>&#39;b00</span><span style=color:#f92672>:</span> wa3 <span style=color:#f92672>=</span> rt;      <span style=color:#75715e>// I-type (rt)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#ae81ff>2</span><span style=color:#ae81ff>&#39;b01</span><span style=color:#f92672>:</span> wa3 <span style=color:#f92672>=</span> rd;      <span style=color:#75715e>// R-type (rd)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#ae81ff>2</span><span style=color:#ae81ff>&#39;b10</span><span style=color:#f92672>:</span> wa3 <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span><span style=color:#ae81ff>&#39;d31</span>;   <span style=color:#75715e>// JAL ($31)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>default</span><span style=color:#f92672>:</span> wa3 <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span><span style=color:#ae81ff>&#39;d0</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>endcase</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Write logic
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>always_ff</span> @(<span style=color:#66d9ef>posedge</span> clk) <span style=color:#66d9ef>begin</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (we3 <span style=color:#f92672>&amp;&amp;</span> wa3 <span style=color:#f92672>!=</span> <span style=color:#ae81ff>5</span><span style=color:#ae81ff>&#39;d0</span>)
</span></span><span style=display:flex><span>            registers[wa3] <span style=color:#f92672>&lt;=</span> wd3;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Read logic
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>assign</span> rd1 <span style=color:#f92672>=</span> registers[ra1];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assign</span> rd2 <span style=color:#f92672>=</span> registers[ra2];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#66d9ef>endmodule</span>
</span></span></code></pre></div><h3 id=write-data-mux-for-jal>Write Data MUX for JAL</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-systemverilog data-lang=systemverilog><span style=display:flex><span><span style=color:#75715e>// JAL needs to write PC+4 to $31
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>assign</span> write_data <span style=color:#f92672>=</span> (opcode <span style=color:#f92672>==</span> <span style=color:#ae81ff>6</span><span style=color:#ae81ff>&#39;b000011</span>) <span style=color:#f92672>?</span> pc_plus4 <span style=color:#f92672>:</span> alu_result;
</span></span></code></pre></div><h2 id=complete-test-program>Complete Test Program</h2><h3 id=assembly-code-ab2-using-subroutines>Assembly Code: (a+b)*2 Using Subroutines</h3><pre tabindex=0><code class=language-assembly data-lang=assembly># Main program to compute (a+b)*2 using JAL
# a = 15, b = 25, expected result = 80

.text
.globl main

main:
    addi $a0, $zero, 15      # $a0 = a = 15 (argument 1)
    addi $a1, $zero, 25      # $a1 = b = 25 (argument 2)
    jal  add_and_double      # Call subroutine, save return in $ra
    sw   $v0, 80($zero)      # Store result at memory address 80
    sw   $v0, 84($zero)      # Store result at address 84 (for test)
    j    end_program         # Jump to end

# Subroutine: add_and_double
# Input: $a0, $a1
# Output: $v0 = ($a0 + $a1) * 2
add_and_double:
    add  $v0, $a0, $a1       # $v0 = a + b = 15 + 25 = 40
    add  $v0, $v0, $v0       # $v0 = $v0 * 2 = 40 * 2 = 80
    jr   $ra                 # Return to caller

end_program:
    j    end_program         # Infinite loop (halt)
</code></pre><h3 id=machine-code-memfiledat>Machine Code (memfile.dat)</h3><pre tabindex=0><code>2004000f    # addi $4, $0, 15
20050019    # addi $5, $0, 25
0c000006    # jal add_and_double (address 24)
ac020050    # sw $2, 80($0)
ac020054    # sw $2, 84($0)
08000009    # j end_program (address 36)
00852020    # add $2, $4, $5
00422020    # add $2, $2, $2
03e00008    # jr $31
08000009    # j end_program (infinite loop)
</code></pre><h3 id=execution-trace>Execution Trace</h3><table><thead><tr><th>Cycle</th><th>PC</th><th>Instruction</th><th>Operation</th><th>Register Updates</th></tr></thead><tbody><tr><td>1</td><td>0</td><td><code>addi $4,$0,15</code></td><td>$4 = 0 + 15</td><td>$4 = 15</td></tr><tr><td>2</td><td>4</td><td><code>addi $5,$0,25</code></td><td>$5 = 0 + 25</td><td>$5 = 25</td></tr><tr><td>3</td><td>8</td><td><code>jal 24</code></td><td>$31 = 12, PC = 24</td><td>$31 = 12</td></tr><tr><td>4</td><td>24</td><td><code>add $2,$4,$5</code></td><td>$2 = 15 + 25</td><td>$2 = 40</td></tr><tr><td>5</td><td>28</td><td><code>add $2,$2,$2</code></td><td>$2 = 40 + 40</td><td>$2 = 80</td></tr><tr><td>6</td><td>32</td><td><code>jr $31</code></td><td>PC = 12</td><td>—</td></tr><tr><td>7</td><td>12</td><td><code>sw $2,80($0)</code></td><td>Mem[80] = 80</td><td>—</td></tr><tr><td>8</td><td>16</td><td><code>sw $2,84($0)</code></td><td>Mem[84] = 80</td><td>—</td></tr><tr><td>9</td><td>20</td><td><code>j 36</code></td><td>PC = 36</td><td>—</td></tr><tr><td>10+</td><td>36</td><td><code>j 36</code></td><td>Infinite loop</td><td>—</td></tr></tbody></table><h2 id=fpga-implementation>FPGA Implementation</h2><h3 id=hardware-features>Hardware Features</h3><p><strong>7-Segment Display:</strong></p><ul><li>HEX7-6: PC[7:0]</li><li>HEX5-4: Opcode</li><li>HEX3-2: Accumulator/ALU Result</li><li>HEX1-0: Memory Output</li></ul><p><strong>Debug Switches:</strong></p><ul><li>SW[17:16]: Display mode selection<ul><li><code>00</code>: Program Counter</li><li><code>01</code>: Current Instruction</li><li><code>10</code>: Write Data</li><li><code>11</code>: Data Address</li></ul></li></ul><p><strong>LEDs:</strong></p><ul><li>LEDG[8]: Memory Write indicator</li><li>LEDR[17:0]: Current switch values</li></ul><h3 id=clock-division-for-debugging>Clock Division for Debugging</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-systemverilog data-lang=systemverilog><span style=display:flex><span><span style=color:#66d9ef>module</span> clock_divider(
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>input</span>  <span style=color:#66d9ef>logic</span> clk_50mhz,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>input</span>  <span style=color:#66d9ef>logic</span> reset,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>output</span> <span style=color:#66d9ef>logic</span> clk_slow
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>parameter</span> DIVISOR <span style=color:#f92672>=</span> <span style=color:#ae81ff>50</span>_000_000;  <span style=color:#75715e>// 1 Hz for debugging
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>logic</span> [<span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>] counter;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>always_ff</span> @(<span style=color:#66d9ef>posedge</span> clk_50mhz <span style=color:#66d9ef>or</span> <span style=color:#66d9ef>posedge</span> reset) <span style=color:#66d9ef>begin</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (reset) <span style=color:#66d9ef>begin</span>
</span></span><span style=display:flex><span>            counter <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>            clk_slow <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>begin</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (counter <span style=color:#f92672>==</span> DIVISOR <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>begin</span>
</span></span><span style=display:flex><span>                counter <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>                clk_slow <span style=color:#f92672>&lt;=</span> <span style=color:#f92672>~</span>clk_slow;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>                counter <span style=color:#f92672>&lt;=</span> counter <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#66d9ef>endmodule</span>
</span></span></code></pre></div><h2 id=timing-analysis>Timing Analysis</h2><h3 id=critical-path-report-timequest>Critical Path Report (TimeQuest)</h3><pre tabindex=0><code>Critical Path Analysis:
┌────────────────────────────┬──────────┐
│ Path Segment               │ Delay    │
├────────────────────────────┼──────────┤
│ PC Register → PC+4         │ 1.2 ns   │
│ Instruction Fetch          │ 3.5 ns   │
│ Instruction Decode         │ 2.1 ns   │
│ Register File Read         │ 2.8 ns   │
│ ALU Operation              │ 6.7 ns   │
│ Data Memory Access         │ 4.2 ns   │
│ Write-back MUX             │ 1.3 ns   │
│ Register File Setup        │ 1.7 ns   │
├────────────────────────────┼──────────┤
│ Total Path Delay           │ 23.5 ns  │
│ Maximum Frequency          │ 42.6 MHz │
│ Target Frequency           │ 50 MHz   │
│ **Timing Violation**       │ **-7.4 ns** │
└────────────────────────────┴──────────┘
</code></pre><p><strong>Optimization Applied:</strong></p><ul><li>Reduced memory access time with faster SRAM</li><li>Optimized ALU critical path</li><li>Final achieved frequency: <strong>52.3 MHz</strong> ✓</li></ul><h3 id=resource-utilization>Resource Utilization</h3><pre tabindex=0><code>Compilation Report - Cyclone IV E (EP4CE115F29C7)
┌──────────────────────┬──────────┬───────────┬────────┐
│ Resource             │ Used     │ Available │ % Used │
├──────────────────────┼──────────┼───────────┼────────┤
│ Logic Elements       │ 2,847    │ 114,480   │ 2.5%   │
│ Dedicated Registers  │ 1,088    │ 114,480   │ 0.9%   │
│ Memory Bits          │ 8,192    │ 3,981,312 │ 0.2%   │
│ Embedded Multipliers │ 0        │ 532       │ 0%     │
│ PLLs                 │ 1        │ 4         │ 25%    │
└──────────────────────┴──────────┴───────────┴────────┘
</code></pre><h2 id=verification--testing>Verification & Testing</h2><h3 id=modelsim-testbench>ModelSim Testbench</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-systemverilog data-lang=systemverilog><span style=display:flex><span><span style=color:#66d9ef>module</span> mips_processor_tb;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>logic</span> clk, reset;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>logic</span> [<span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>] write_data, data_addr;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Instantiate DUT
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    mips_top dut(
</span></span><span style=display:flex><span>        .clk(clk),
</span></span><span style=display:flex><span>        .reset(reset),
</span></span><span style=display:flex><span>        .write_data(write_data),
</span></span><span style=display:flex><span>        .data_addr(data_addr)
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Clock generation
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>initial</span> <span style=color:#66d9ef>begin</span>
</span></span><span style=display:flex><span>        clk <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>forever</span> #<span style=color:#ae81ff>10</span> clk <span style=color:#f92672>=</span> <span style=color:#f92672>~</span>clk;  <span style=color:#75715e>// 50MHz clock
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Test stimulus
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>initial</span> <span style=color:#66d9ef>begin</span>
</span></span><span style=display:flex><span>        $display(<span style=color:#e6db74>&#34;Starting MIPS JAL/JR Test...&#34;</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Reset
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        reset <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        #<span style=color:#ae81ff>25</span> reset <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Wait for program execution
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        #<span style=color:#ae81ff>1000</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Check result at memory address 80
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (dut.dmem.RAM[<span style=color:#ae81ff>80</span>] <span style=color:#f92672>!==</span> <span style=color:#ae81ff>32</span><span style=color:#ae81ff>&#39;d80</span>) <span style=color:#66d9ef>begin</span>
</span></span><span style=display:flex><span>            $display(<span style=color:#e6db74>&#34;ERROR: Memory[80] = %d, expected 80&#34;</span>, 
</span></span><span style=display:flex><span>                     dut.dmem.RAM[<span style=color:#ae81ff>80</span>]);
</span></span><span style=display:flex><span>            $stop;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $display(<span style=color:#e6db74>&#34;✓ Test PASSED: Result = %d&#34;</span>, dut.dmem.RAM[<span style=color:#ae81ff>80</span>]);
</span></span><span style=display:flex><span>        $display(<span style=color:#e6db74>&#34;✓ JAL saved return address correctly&#34;</span>);
</span></span><span style=display:flex><span>        $display(<span style=color:#e6db74>&#34;✓ JR returned to correct location&#34;</span>);
</span></span><span style=display:flex><span>        $finish;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Monitor key signals
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>initial</span> <span style=color:#66d9ef>begin</span>
</span></span><span style=display:flex><span>        $monitor(<span style=color:#e6db74>&#34;Time=%0t PC=%h Instr=%h WriteData=%h&#34;</span>, 
</span></span><span style=display:flex><span>                 $time, dut.pc, dut.instr, write_data);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#66d9ef>endmodule</span>
</span></span></code></pre></div><p><strong>Output:</strong></p><pre tabindex=0><code>Starting MIPS JAL/JR Test...
Time=0 PC=00000000 Instr=2004000f WriteData=xxxxxxxx
Time=20 PC=00000004 Instr=20050019 WriteData=0000000f
Time=40 PC=00000008 Instr=0c000006 WriteData=00000019
Time=60 PC=00000018 Instr=00852020 WriteData=0000000c
Time=80 PC=0000001c Instr=00422020 WriteData=00000028
Time=100 PC=00000020 Instr=03e00008 WriteData=00000050
Time=120 PC=0000000c Instr=ac020050 WriteData=00000050
✓ Test PASSED: Result = 80
✓ JAL saved return address correctly
✓ JR returned to correct location
</code></pre><h2 id=control-signal-truth-table>Control Signal Truth Table</h2><h3 id=main-decoder>Main Decoder</h3><table><thead><tr><th>Opcode</th><th>Instruction</th><th>RegWrite</th><th>MemtoReg</th><th>MemWrite</th><th>ALUSrc</th><th>RegDst</th><th>PCSrc</th></tr></thead><tbody><tr><td>000000</td><td>R-type</td><td>1</td><td>0</td><td>0</td><td>0</td><td>01</td><td>00</td></tr><tr><td>000000</td><td>JR</td><td>0</td><td>X</td><td>0</td><td>X</td><td>XX</td><td>11</td></tr><tr><td>000011</td><td>JAL</td><td>1</td><td>0</td><td>0</td><td>X</td><td>10</td><td>10</td></tr><tr><td>100011</td><td>LW</td><td>1</td><td>1</td><td>0</td><td>1</td><td>00</td><td>00</td></tr><tr><td>101011</td><td>SW</td><td>0</td><td>X</td><td>1</td><td>1</td><td>XX</td><td>00</td></tr><tr><td>001000</td><td>ADDI</td><td>1</td><td>0</td><td>0</td><td>1</td><td>00</td><td>00</td></tr></tbody></table><h3 id=alu-decoder>ALU Decoder</h3><table><thead><tr><th>ALUOp</th><th>Funct</th><th>Instruction</th><th>ALUControl</th></tr></thead><tbody><tr><td>10</td><td>100000</td><td>ADD</td><td>010</td></tr><tr><td>10</td><td>100010</td><td>SUB</td><td>110</td></tr><tr><td>10</td><td>100100</td><td>AND</td><td>000</td></tr><tr><td>10</td><td>100101</td><td>OR</td><td>001</td></tr><tr><td>10</td><td>101010</td><td>SLT</td><td>111</td></tr><tr><td>00</td><td>XXXXXX</td><td>LW/SW/ADDI</td><td>010</td></tr></tbody></table><h2 id=skills-demonstrated>Skills Demonstrated</h2><p>✅ <strong>MIPS Architecture:</strong> Deep understanding of Load/Store design<br>✅ <strong>Subroutine Mechanisms:</strong> Implementation of JAL/JR calling conventions<br>✅ <strong>SystemVerilog:</strong> Advanced HDL techniques and testbenches<br>✅ <strong>Datapath Design:</strong> Complex MUX networks and control signals<br>✅ <strong>FPGA Deployment:</strong> Complete system integration on DE2-115<br>✅ <strong>Timing Analysis:</strong> Critical path optimization with TimeQuest<br>✅ <strong>Assembly Programming:</strong> Writing and debugging MIPS assembly<br>✅ <strong>Hardware Debugging:</strong> 7-segment display integration for real-time monitoring</p><h2 id=challenges--solutions>Challenges & Solutions</h2><h3 id=challenge-1-register-write-conflicts>Challenge 1: Register Write Conflicts</h3><p><strong>Problem:</strong> JAL writes to $31 while other instructions write to rt or rd</p><p><strong>Solution:</strong> Implemented 3-way MUX for write address selection with proper priority encoding</p><h3 id=challenge-2-pc-source-selection>Challenge 2: PC Source Selection</h3><p><strong>Problem:</strong> Multiple PC update sources (PC+4, branch, JAL, JR)</p><p><strong>Solution:</strong> Created 4-way PC source MUX with proper control signal generation from opcode/funct fields</p><h3 id=challenge-3-return-address-timing>Challenge 3: Return Address Timing</h3><p><strong>Problem:</strong> PC+4 needed to be ready when JAL writes to $31</p><p><strong>Solution:</strong> Ensured PC+4 calculation happens in parallel with instruction decode</p><h2 id=conclusion>Conclusion</h2><p>This MIPS processor implementation successfully demonstrates the fundamental principles of RISC architecture with emphasis on subroutine support. The addition of JAL and JR instructions enables structured programming with function calls and returns, making the processor capable of running more complex software.</p><p>The project showcases the complete design flow from architecture specification through SystemVerilog implementation, simulation verification, and final FPGA deployment with real-time debugging capabilities.</p><hr><p><strong>GitHub Repository:</strong> <a href=https://github.com/Will-L10>View Code</a><br><strong>Lab Report:</strong> Complete documentation with timing analysis<br><strong>Demo Video:</strong> FPGA demonstration available</p></article></div></div><div class="col-sm-12 col-md-12 col-lg-3"><div id=stickySideBar class=sticky-sidebar><aside class=toc><h5>Table Of Contents</h5><div class=toc-content><nav id=TableOfContents><ul><li><a href=#project-overview>Project Overview</a><ul><li><a href=#project-specifications>Project Specifications</a></li></ul></li><li><a href=#architecture-overview>Architecture Overview</a><ul><li><a href=#mips-processor-block-diagram>MIPS Processor Block Diagram</a></li><li><a href=#core-features>Core Features</a></li></ul></li><li><a href=#instruction-set-extensions>Instruction Set Extensions</a><ul><li><a href=#jal-jump-and-link>JAL (Jump and Link)</a></li><li><a href=#jr-jump-register>JR (Jump Register)</a></li></ul></li><li><a href=#datapath-extensions-for-jaljr>Datapath Extensions for JAL/JR</a><ul><li><a href=#register-destination-mux>Register Destination MUX</a></li><li><a href=#write-data-mux-for-jal>Write Data MUX for JAL</a></li></ul></li><li><a href=#complete-test-program>Complete Test Program</a><ul><li><a href=#assembly-code-ab2-using-subroutines>Assembly Code: (a+b)*2 Using Subroutines</a></li><li><a href=#machine-code-memfiledat>Machine Code (memfile.dat)</a></li><li><a href=#execution-trace>Execution Trace</a></li></ul></li><li><a href=#fpga-implementation>FPGA Implementation</a><ul><li><a href=#hardware-features>Hardware Features</a></li><li><a href=#clock-division-for-debugging>Clock Division for Debugging</a></li></ul></li><li><a href=#timing-analysis>Timing Analysis</a><ul><li><a href=#critical-path-report-timequest>Critical Path Report (TimeQuest)</a></li><li><a href=#resource-utilization>Resource Utilization</a></li></ul></li><li><a href=#verification--testing>Verification & Testing</a><ul><li><a href=#modelsim-testbench>ModelSim Testbench</a></li></ul></li><li><a href=#control-signal-truth-table>Control Signal Truth Table</a><ul><li><a href=#main-decoder>Main Decoder</a></li><li><a href=#alu-decoder>ALU Decoder</a></li></ul></li><li><a href=#skills-demonstrated>Skills Demonstrated</a></li><li><a href=#challenges--solutions>Challenges & Solutions</a><ul><li><a href=#challenge-1-register-write-conflicts>Challenge 1: Register Write Conflicts</a></li><li><a href=#challenge-2-pc-source-selection>Challenge 2: PC Source Selection</a></li><li><a href=#challenge-3-return-address-timing>Challenge 3: Return Address Timing</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></aside><aside class=tags><h5>Tags</h5><ul class="tags-ul list-unstyled list-inline"><li class=list-inline-item><a href=https://will-l10.github.io/tags/mips target=_blank>MIPS</a></li><li class=list-inline-item><a href=https://will-l10.github.io/tags/fpga target=_blank>FPGA</a></li><li class=list-inline-item><a href=https://will-l10.github.io/tags/systemverilog target=_blank>SystemVerilog</a></li><li class=list-inline-item><a href=https://will-l10.github.io/tags/pipelining target=_blank>Pipelining</a></li></ul></aside><aside class=social><h5>Social</h5><div class=social-content><ul class=list-inline><li class="list-inline-item text-center"><a target=_blank href="https://www.linkedin.com/feed/?shareActive=true&text=Single-cycle%20MIPS%20processor%20with%20subroutine%20support%20%28JAL%2fJR%20instructions%29 https%3a%2f%2fwill-l10.github.io%2fblogs%2fmips-processor%2f"><i class="fab fa-linkedin"></i></a></li><li class="list-inline-item text-center"><a target=_blank href='https://twitter.com/share?text=MIPS%20Processor%20with%20Extended%20ISA&url=https%3a%2f%2fwill-l10.github.io%2fblogs%2fmips-processor%2f&hashtags=MIPS%2cFPGA%2cSystemVerilog%2cPipelining'><i class="fab fa-twitter"></i></a></li><li class="list-inline-item text-center"><a target=_blank href="https://api.whatsapp.com/send?text=MIPS%20Processor%20with%20Extended%20ISA: https%3a%2f%2fwill-l10.github.io%2fblogs%2fmips-processor%2f"><i class="fab fa-whatsapp"></i></a></li><li class="list-inline-item text-center"><a target=_blank href='mailto:?subject=MIPS%20Processor%20with%20Extended%20ISA&amp;body=Check%20out%20this%20site https%3a%2f%2fwill-l10.github.io%2fblogs%2fmips-processor%2f'><i class="fa fa-envelope"></i></a></li></ul></div></aside></div></div></div><div class=row><div class="col-sm-12 col-md-12 col-lg-9 p-4"></div></div></div><button class="p-2 px-3" onclick=topFunction() id=topScroll>
<i class="fas fa-angle-up"></i></button></section><div class=progress><div id=scroll-progress-bar class=progress-bar role=progressbar aria-valuenow=0 aria-valuemin=0 aria-valuemax=100></div></div><script src=/js/scrollProgressBar.js></script><script>var topScroll=document.getElementById("topScroll");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?topScroll.style.display="block":topScroll.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}let stickySideBarElem=document.getElementById("stickySideBar"),stickyNavBar=!1;if(stickyNavBar){let e=document.getElementById("profileHeader"),t=e.offsetHeight+15;stickySideBarElem.style.top=t+"px"}else stickySideBarElem.style.top="50px"</script><script src=/js/readingTime.js></script></div><footer><div class="container py-3" id=recent-posts><div class="h3 text-center text-secondary py-3">Projects</div><div class="row justify-content-center"><div class="col-lg-4 col-md-6 pt-2"><div class="card h-100"><div class=card-header><a href=/blogs/custom-processor/><img src=/images/projects/processor.jpg class=card-img-top alt="Custom 8-Bit Multicycle Processor"></a></div><div class="card-body bg-transparent p-3 shadow-sm"><a href=/blogs/custom-processor/ class="primary-font card-title"><h5 class="card-title bg-transparent" title="Custom 8-Bit Multicycle Processor">Custom 8-Bit Multicycle …</h5></a><div class="card-text secondary-font"><p><h2 id=project-overview>Project Overview</h2><p>Designed and implemented a <strong>complete custom 8-bit multicycle processor</strong> from the ground up, featuring a 16-instruction ISA and FSM-based control unit. This processor successfully executes complex matrix operations entirely in software using integer arithmetic.</p><p><img src=/images/projects/processor.jpg alt="Processor Block Diagram"></p><h3 id=key-specifications>Key Specifications …</h3></p></div></div><div class="mt-auto card-footer"><span class=float-start>Nov 16, 2024</span>
<a href=/blogs/custom-processor/ class="float-end btn btn-outline-info btn-sm">Read</a></div></div></div><div class="col-lg-4 col-md-6 pt-2"><div class="card h-100"><div class=card-header><a href=/blogs/arm-processor/><img src=/images/projects/arm.jpg class=card-img-top alt="ARM Processor Implementation"></a></div><div class="card-body bg-transparent p-3 shadow-sm"><a href=/blogs/arm-processor/ class="primary-font card-title"><h5 class="card-title bg-transparent" title="ARM Processor Implementation">ARM Processor …</h5></a><div class="card-text secondary-font"><p><h2 id=project-overview>Project Overview</h2><p>Implemented a complete <strong>single-cycle ARM processor</strong> with extended instruction set on FPGA hardware, demonstrating proficiency in computer architecture and hardware description languages. Successfully added custom <strong>EOR (Exclusive OR)</strong> and <strong>LDRB (Load Register Byte)</strong> instructions to the …</p></p></div></div><div class="mt-auto card-footer"><span class=float-start>Oct 15, 2024</span>
<a href=/blogs/arm-processor/ class="float-end btn btn-outline-info btn-sm">Read</a></div></div></div><div class="col-lg-4 col-md-6 pt-2"><div class="card h-100"><div class=card-header><a href=/blogs/mips-processor/><img src=/images/projects/mips.jpg class=card-img-top alt="MIPS Processor with Extended ISA"></a></div><div class="card-body bg-transparent p-3 shadow-sm"><a href=/blogs/mips-processor/ class="primary-font card-title"><h5 class="card-title bg-transparent" title="MIPS Processor with Extended ISA">MIPS Processor with …</h5></a><div class="card-text secondary-font"><p><h2 id=project-overview>Project Overview</h2><p>Designed and implemented a complete <strong>single-cycle MIPS processor</strong> supporting Load/Store architecture with <strong>32 general-purpose registers</strong>. Successfully added <strong>JAL (Jump and Link)</strong> and <strong>JR (Jump Register)</strong> instructions to enable subroutine calls and returns—essential for structured …</p></p></div></div><div class="mt-auto card-footer"><span class=float-start>Sep 20, 2024</span>
<a href=/blogs/mips-processor/ class="float-end btn btn-outline-info btn-sm">Read</a></div></div></div><div class="col-lg-4 col-md-6 pt-2"><div class="card h-100"><div class=card-header><a href=/blogs/gcd-algorithm/><img src=/images/projects/gcd.jpg class=card-img-top alt="GCD Algorithm Hardware Implementation"></a></div><div class="card-body bg-transparent p-3 shadow-sm"><a href=/blogs/gcd-algorithm/ class="primary-font card-title"><h5 class="card-title bg-transparent" title="GCD Algorithm Hardware Implementation">GCD Algorithm Hardware …</h5></a><div class="card-text secondary-font"><p><h2 id=project-overview>Project Overview</h2><p>Designed and implemented a <strong>hardware-based Greatest Common Divisor (GCD) calculator</strong> using the Euclidean algorithm. This project transforms a classic software algorithm into optimized digital hardware using a finite state machine, demonstrating the fundamental differences between …</p></p></div></div><div class="mt-auto card-footer"><span class=float-start>Aug 10, 2024</span>
<a href=/blogs/gcd-algorithm/ class="float-end btn btn-outline-info btn-sm">Read</a></div></div></div><div class="col-lg-4 col-md-6 pt-2"><div class="card h-100"><div class=card-header><a href=/blogs/construction-portfolio/><img src=/images/projects/construction1.jpg class=card-img-top alt="Construction & Renovation Portfolio"></a></div><div class="card-body bg-transparent p-3 shadow-sm"><a href=/blogs/construction-portfolio/ class="primary-font card-title"><h5 class="card-title bg-transparent" title="Construction & Renovation Portfolio">Construction & Renovation …</h5></a><div class="card-text secondary-font"><p><h2 id=overview>Overview</h2><p>Since 2019, I&rsquo;ve gained extensive hands-on construction experience through my family&rsquo;s renovation business, developing expertise in <strong>residential electrical installation</strong>, <strong>hardwood flooring</strong>, <strong>bathroom remodeling</strong>, and general construction techniques. This practical experience has …</p></p></div></div><div class="mt-auto card-footer"><span class=float-start>Jul 15, 2024</span>
<a href=/blogs/construction-portfolio/ class="float-end btn btn-outline-info btn-sm">Read</a></div></div></div></div></div><div class="text-center pt-2"><span class=px-1><a href=https://github.com/Will-L10 target=_blank aria-label=github><svg width="2.7em" height="2.7em" viewBox="0 0 1792 1792"><path id="footer-socialNetworks-github-svg-path" d="M522 1352q-8 9-20-3-13-11-4-19 8-9 20 3 12 11 4 19zm-42-61q9 12 0 19-8 6-17-7t0-18q9-7 17 6zm-61-60q-5 7-13 2-10-5-7-12 3-5 13-2 10 5 7 12zm31 34q-6 7-16-3-9-11-2-16 6-6 16 3 9 11 2 16zm129 112q-4 12-19 6-17-4-13-15t19-7q16 5 13 16zm63 5q0 11-16 11-17 2-17-11 0-11 16-11 17-2 17 11zm58-10q2 10-14 14t-18-8 14-15q16-2 18 9zm964-956v960q0 119-84.5 203.5T1376 1664h-224q-16 0-24.5-1t-19.5-5-16-14.5-5-27.5v-239q0-97-52-142 57-6 102.5-18t94-39 81-66.5 53-105T1386 856q0-121-79-206 37-91-8-204-28-9-81 11t-92 44l-38 24q-93-26-192-26t-192 26q-16-11-42.5-27T578 459.5 492 446q-44 113-7 204-79 85-79 206 0 85 20.5 150t52.5 105 80.5 67 94 39 102.5 18q-40 36-49 103-21 10-45 15t-57 5-65.5-21.5T484 1274q-19-32-48.5-52t-49.5-24l-20-3q-21 0-29 4.5t-5 11.5 9 14 13 12l7 5q22 10 43.5 38t31.5 51l10 23q13 38 44 61.5t67 30 69.5 7 55.5-3.5l23-4q0 38 .5 103t.5 68q0 22-11 33.5t-22 13-33 1.5H416q-119 0-203.5-84.5T128 1376V416q0-119 84.5-203.5T416 128h960q119 0 203.5 84.5T1664 416z"/></svg>
</a></span><span class=px-1><a href=https://linkedin.com/in/williamlazcano target=_blank aria-label=linkedin><svg width="2.4em" height="2.4em" fill="#fff" aria-label="LinkedIn" viewBox="0 0 512 512"><rect width="512" height="512" fill="#0077b5" rx="15%"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg></a></span></div><div class="container py-4"><div class="row justify-content-center"><div class="col-md-4 text-center"><div class=pb-2><a href=https://will-l10.github.io/ title="William Lazcano | Computer & Electrical Engineering"><img alt="Footer logo" src=/images/favicon.png height=40px width=40px></a></div>&copy; 2025 All rights reserved<div class=text-secondary>Made with
<span class=text-danger>&#10084;
</span>and
<a href=https://github.com/gurusabarish/hugo-profile target=_blank title="Designed and developed by gurusabarish">Hugo Profile</a></div></div></div></div></footer><script src=/bootstrap-5/js/bootstrap.bundle.min.js></script><script>localStorage.getItem("pref-theme")==="dark"?(document.documentElement.classList.add("dark"),document.body.classList.add("dark")):localStorage.getItem("pref-theme")==="light"?(document.body.classList.remove("dark"),document.documentElement.classList.remove("dark")):window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(document.documentElement.classList.add("dark"),document.body.classList.add("dark"))</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),document.documentElement.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),document.documentElement.classList.add("dark"),localStorage.setItem("pref-theme","dark"))});var tooltipTriggerList=[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')),tooltipList=tooltipTriggerList.map(function(e){return new bootstrap.Tooltip(e)})</script><script src=/js/search.js></script><section id=search-content class=py-2><div class=container id=search-results></div></section></body></html>